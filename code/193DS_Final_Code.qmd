---
title: "193DS_Final_Code"
authors: Graycen Mahon, Benise Limon, Kiya Pupa
data: "2023-06-12"
output:
  html_document:
    code_folding: hide
---

# Problem 1

**Context:** Read Koontz and Simpson 2010, "The composition of seed banks on kangaroo rat (Dipodomys spectabilis) mounds in a Chihuahuan Desert grassland." Journal of Arid Environments. https://doi.org/10.1016/j.jaridenv.2010.03.008\
**Data:** Koontz, T. and H. Simpson. 2013. Effects of Kangaroo Rat Mounds on Seed Banks of Grass and Shrublands at the Sevilleta National Wildlife Refuge, New Mexico (2001) ver 102459. Environmental Data Initiative.\
https://doi.org/10.6073/pasta/115b8095a5e82028869a8c56eff14597\
**Question:** How does total seed number differ between kangaroo rat mound locations?

## Introduction

○ To your specific analysis (biology or otherwise) with 3-5 citations (3-5\
sentences

For the first data set which is the study of the effects of Kangaroo Rat Mounds on Seed Banks of Grass and Shrublands at the Sevilleta National Wildlife Refuge, New Mexico, we analyzed the data in order to answer the question, "How does the total seed number differ between kangaroo rat mound locations?".

## Methods

○ Any cleaning and wrangling steps\
○ Assumption checks\
○ Statistical tests and null hypotheses\
○ Citations for packages, software, data, or other steps

```{r loading-in-packages1}
library(tidyverse)
library(here)
library(janitor)
library(ggeffects)
library(performance)
library(naniar) 
library(flextable)
library(car)
library(broom)
library(corrplot)
library(AICcmodavg)
library(GGally)
```

```{r read-data}
# checking to make sure the "here" package is starting at the correct directory
here()

#reading in data set
krat <- read_csv(here("data/sev208_kratseedbank_20120213.csv"))
```

```{r miss-vis}
#visualizing missing observations
gg_miss_var(krat)
#nothing missing!
```

```{r explore-data}
ggplot(data = krat, aes(x = mnd, y = seeds)) +
  geom_col()
```

```{r model-object}
krat_modelobject <- lm(mnd ~ seeds, data = krat)
```

```{r plot-assumptions}
# makes the viewer pane show a 2x2 grid of plots
# format: par(mfrow = c(number of rows, number of columns))
par(mfrow = c(2, 2))
plot(krat_modelobject)
```

```{r dev-off}
# turns off the 2x2 grid - pop this under the code chunk where you set the 2x2 grid
dev.off()
```

## Results

○ Interpretation of main results in the context of the system\
○ Relevant test statistics, degrees of freedom, p-values, significance levels, etc.\
○ A visualization of some kind reflecting the analysis you did (comparison of groups and/or relationships between variables) with a caption\
○ A table (if appropriate) with a caption

# Problem 2

**Data:** Seaver, M. 2022. Individual and community flowering phenology, seed counts and pollinator\
visitation rates in shrub and open plots across Niwot Ridge, 2019 - 2021. ver 1. Environmental Data Initiative. https://doi.org/10.6073/pasta/edc4ab2faf7dd96cd1deac1544d5f2b9\
**Questions:** How does seed count vary with plot type (shrub or open), plant species, and total number of inflorescences? Is there a simpler model that explains seed count, and if so, what is it?

## Introduction

○ To your specific analysis (biology or otherwise) with 3-5 citations (3-5\
sentences

## Methods

  For the second problem, we began by reading in the csv file and naming a new object called seed. In order to 

○ Any cleaning and wrangling steps\
○ Assumption checks\
○ Statistical tests and null hypotheses\
○ Citations for packages, software, data, or other steps

```{r knitr-example, eval = FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
# suppress any messages from R using the code chunk above, setting messages and warnings to false}
```

```{r reading-in-the-dataset}
#reading in the data sets for problem 2
seed <- read_csv(here("data/shrubstudy_seed_ctwt.ms.data.csv"))
```

```{r cleaning-the-data}
seed %>% 
  clean_names() %>% 
  select(species, treatment, nr_seeds, total_nr_infl)
```

```{r missing-data-visualization-(1-4)}
# visualizing miss data points
gg_miss_var(seed)
```

```{r}
# creating a seed subset object and dropping na values from the table
seed_subset <- seed
seed_subset[is.na(seed_subset) | seed_subset == "Inf"] <- NA 
#seed_subset[drop_na(nr_seeds)]
```

```{r}
null_model <- lm(nr_seeds ~ 1, data = seed_subset)
```

```{r model-object-species}
seed_model_object <-lm(nr_seeds ~ species + total_nr_infl + treatment, data = seed_subset)
plot(seed_model_object)
```

<<<<<<< HEAD

```{r}
# create a new model taking the log of the relationship between total mass and species type
full_log <- lm(log(nr_seeds) ~ species + total_nr_infl + treatment, data = seed_subset)
#plotting to visually assess normality and homoscedasticity
par(mfrow = c(2, 2))
plot(full_log)
```


```{r}
# Shapiro-Wilk test 
check_normality(full_log)
# Breusch-Pagan test
check_heteroscedasticity(full_log)
```


=======
>>>>>>> f763bbac2c62cc5f0cb063a5223bf13173f318ba
```{r explore-data-species}
ggplot(data = seed_subset, aes(x = nr_seeds, y = species), na.rm = TRUE) + geom_col()
```

```{r explore-data-inflorescences}
ggplot(data = seed_subset, aes(x = nr_seeds, y = total_nr_infl), na.rm = TRUE) + geom_col()
```

## Results

○ Interpretation of main results in the context of the system\
○ Relevant test statistics, degrees of freedom, p-values, significance levels, etc.\
○ A visualization of some kind reflecting the analysis you did (comparison of groups and/or relationships between variables) with a caption\
○ A table (if appropriate) with a caption
